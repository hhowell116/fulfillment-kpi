<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RCO Fulfillment Dashboard</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #f5f5f0 0%, #e8e4d9 100%); min-height: 100vh; padding: 20px; }
.container { max-width: 1400px; margin: 0 auto; }
header { background: linear-gradient(135deg, #ffffff 0%, #f5f0e8 100%); padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); margin-bottom: 30px; border: 1px solid rgba(210, 180, 140, 0.2); }
h1 { color: #8b7355; font-size: 2.5em; font-weight: 600; letter-spacing: -0.5px; }
.subtitle { color: #a0906f; font-size: 1.1em; margin-top: 8px; }
.controls { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); margin-bottom: 25px; display: flex; gap: 15px; align-items: center; flex-wrap: wrap; }
.view-toggle { display: flex; gap: 10px; margin-left: auto; }
.view-btn { padding: 10px 20px; border: 2px solid #d2b48c; border-radius: 10px; background: white; color: #8b7355; font-size: 0.95em; cursor: pointer; transition: all 0.3s ease; }
.view-btn.active { background: linear-gradient(135deg, #d2b48c 0%, #c4a57b 100%); color: white; border-color: #c4a57b; }
.view-btn:hover:not(.active) { background: #faf8f5; }
select { padding: 12px 20px; border: 2px solid #d2b48c; border-radius: 10px; background: white; color: #8b7355; font-size: 1em; cursor: pointer; transition: all 0.3s ease; }
select:hover { border-color: #a0906f; box-shadow: 0 2px 10px rgba(210, 180, 140, 0.2); }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
.stat-card { background: linear-gradient(135deg, #ffffff 0%, #faf8f5 100%); padding: 25px; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.06); border: 1px solid rgba(210, 180, 140, 0.15); transition: transform 0.3s ease, box-shadow 0.3s ease; }
.stat-card:hover { transform: translateY(-5px); box-shadow: 0 8px 35px rgba(0,0,0,0.1); }
.stat-label { color: #a0906f; font-size: 0.9em; font-weight: 500; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; }
.stat-value { color: #8b7355; font-size: 2.2em; font-weight: 700; }
.stat-subtitle { color: #b8a68f; font-size: 0.85em; margin-top: 8px; }
.chart-container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.06); margin-bottom: 20px; min-width: 0; }
.charts-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; min-width: 0; }
.table-container { background: white; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.06); overflow-x: auto; margin-bottom: 30px; }
.chart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
.chart-title { color: #8b7355; font-size: 1.2em; font-weight: 600; }
.legend { display: flex; gap: 15px; flex-wrap: wrap; }
.legend-item { display: flex; align-items: center; gap: 6px; }
.legend-color { width: 14px; height: 14px; border-radius: 3px; }
.legend-label { color: #8b7355; font-size: 0.8em; }
table { width: 100%; border-collapse: collapse; }
.table-container tbody { display: table-row-group; max-height: none; overflow: visible; }
.table-container thead, .table-container tbody tr { display: table; width: 100%; table-layout: fixed; }
thead { background: linear-gradient(135deg, #8b7355 0%, #a0906f 100%); color: white; position: sticky; top: 0; z-index: 10; }
th { padding: 18px 15px; text-align: left; font-weight: 600; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px; }
td { padding: 15px; border-bottom: 1px solid #f0ebe3; color: #6b5d4f; }
tbody tr { transition: background 0.2s ease; }
tbody tr:hover { background: #faf8f5; }
.rate-good { color: #5a8c5a; font-weight: 600; }
.rate-warning { color: #d4a05c; font-weight: 600; }
.rate-poor { color: #c67b7b; font-weight: 600; }
.calendar-view { display: none; }
.calendar-view.active { display: block; }
.calendar-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; margin-bottom: 30px; }
.month-calendar { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.06); min-width: 0; }
.month-header { color: #8b7355; font-size: 1.2em; font-weight: 600; margin-bottom: 15px; text-align: center; }
.calendar-days { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); gap: 4px; width: 100%; }
.day-label { text-align: center; font-size: 0.75em; color: #a0906f; font-weight: 600; padding: 6px 2px; display: flex; align-items: center; justify-content: center; min-width: 0; }
.calendar-day { aspect-ratio: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 6px; font-size: 0.7em; cursor: pointer; transition: all 0.2s ease; position: relative; padding: 4px 2px; text-align: center; min-width: 0; overflow: hidden; }
.calendar-day:hover { transform: scale(1.05); box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
.calendar-day.empty { cursor: default; }
.calendar-day.empty:hover { transform: none; box-shadow: none; }
.day-number { font-weight: 600; margin-bottom: 1px; font-size: 1em; }
.day-rate { font-size: 0.85em; font-weight: 600; white-space: nowrap; }
.tooltip { position: fixed; background: rgba(0, 0, 0, 0.9); color: white; padding: 12px; border-radius: 8px; font-size: 0.85em; pointer-events: none; z-index: 1000; display: none; max-width: 250px; }
.tooltip.show { display: block; }
.monthly-view { display: none; }
.monthly-view.active { display: block; }
.chart-container canvas { height: 300px !important; max-height: 350px !important; width: 100% !important; }
@media (max-width: 768px) {
    h1 { font-size: 1.8em; }
    .stats-grid, .calendar-grid { grid-template-columns: 1fr; }
    .charts-row { grid-template-columns: 1fr; }
    .chart-container canvas { height: 250px !important; }
}
</style>
</head>
<body>
<div class="container">
    <header>
        <h1>ðŸ“¦ RCO Fulfillment Dashboard</h1>
        <div class="subtitle">Real-time order fulfillment analytics and KPIs</div>
    </header>
    <div class="controls">
        <select id="yearSelect">
            <option value="2025">2025</option>
            <option value="2026">2026</option>
        </select>
        <select id="monthSelect">
            <option value="0">January</option><option value="1">February</option><option value="2">March</option><option value="3">April</option><option value="4">May</option><option value="5">June</option><option value="6">July</option><option value="7">August</option><option value="8">September</option><option value="9">October</option><option value="10">November</option><option value="11">December</option>
        </select>
        <div class="view-toggle">
            <button class="view-btn active" data-view="monthly">Monthly</button>
            <button class="view-btn" data-view="calendar">Calendar</button>
        </div>
    </div>
    <div class="stats-grid">
        <div class="stat-card"><div class="stat-label">Monthly Fill Rate (4 Day)</div><div class="stat-value" id="fillRate4Day">-</div><div class="stat-subtitle">Target: 85%</div></div>
        <div class="stat-card"><div class="stat-label">Monthly Fill Rate (7 Day)</div><div class="stat-value" id="fillRate7Day">-</div><div class="stat-subtitle">Target: 95%</div></div>
        <div class="stat-card"><div class="stat-label">Total Orders Processed</div><div class="stat-value" id="totalOrders">-</div><div class="stat-subtitle">This <span id="periodLabel">month</span></div></div>
        <div class="stat-card"><div class="stat-label">Average Daily Orders</div><div class="stat-value" id="avgOrders">-</div><div class="stat-subtitle">Per day</div></div>
    </div>
    <div class="monthly-view active">
        <div class="charts-row">
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Daily Fulfillment Rates</h2>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-color" style="background: #d2b48c;"></div><span class="legend-label">4 Day Rate</span></div>
                        <div class="legend-item"><div class="legend-color" style="background: #8b7355;"></div><span class="legend-label">7 Day Rate</span></div>
                    </div>
                </div>
                <canvas id="fillRateChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-header"><h2 class="chart-title">Orders Remaining Over Time</h2></div>
                <canvas id="ordersChart"></canvas>
            </div>
        </div>
        <div class="table-container">
            <table>
                <thead><tr><th>Date</th><th>Orders Received</th><th>Remaining (4 Day)</th><th>Remaining (7 Day)</th><th>Fill Rate (4 Day)</th><th>Fill Rate (7 Day)</th></tr></thead>
                <tbody id="dataTable"></tbody>
            </table>
        </div>
    </div>
    <div class="calendar-view"><div class="calendar-grid" id="calendarGrid"></div></div>
    <div class="tooltip" id="tooltip"></div>
</div>
<script src="data.js"></script>
<script>
let currentMonth=new Date().getMonth(),currentYear=2025,currentView='monthly',fillRateChart,ordersChart;

function parseDate(d){const p=d.split('/');return new Date(parseInt(p[2]),parseInt(p[0])-1,parseInt(p[1]))}

// Include all days of month
function getMonthData(y,m){
    const dim=new Date(y,m+1,0).getDate();
    let md=[];
    for(let d=1;d<=dim;d++){
        const dayData=fullData.find(i=>{const dt=parseDate(i.date);return dt.getFullYear()===y&&dt.getMonth()===m&&dt.getDate()===d});
        if(dayData){
            md.push(dayData);
        } else {
            md.push({date:`${m+1}/${d}/${y}`,orders:0,rem4:0,rem7:0,rate4:0,rate7:0});
        }
    }
    return md;
}

function getYearData(y){return fullData.filter(d=>parseDate(d.date).getFullYear()===y)}

function updateDashboard(){
    if(currentView==='calendar'){
        renderCalendarView();
        const yd=getYearData(currentYear);
        if(!yd.length){document.getElementById('fillRate4Day').textContent='N/A';document.getElementById('fillRate7Day').textContent='N/A';document.getElementById('totalOrders').textContent='0';document.getElementById('avgOrders').textContent='0';return}
        const a4=yd.reduce((s,d)=>s+d.rate4,0)/yd.length,a7=yd.reduce((s,d)=>s+d.rate7,0)/yd.length,tot=yd.reduce((s,d)=>s+d.orders,0);
        document.getElementById('fillRate4Day').textContent=a4.toFixed(0)+'%';
        document.getElementById('fillRate7Day').textContent=a7.toFixed(0)+'%';
        document.getElementById('totalOrders').textContent=tot.toLocaleString();
        document.getElementById('avgOrders').textContent=Math.round(tot/yd.length).toLocaleString();
        document.getElementById('periodLabel').textContent='year';
    } else {
        const md=getMonthData(currentYear,currentMonth);
        const a4=md.reduce((s,d)=>s+d.rate4,0)/md.length,a7=md.reduce((s,d)=>s+d.rate7,0)/md.length,tot=md.reduce((s,d)=>s+d.orders,0);
        document.getElementById('fillRate4Day').textContent=a4.toFixed(0)+'%';
        document.getElementById('fillRate7Day').textContent=a7.toFixed(0)+'%';
        document.getElementById('totalOrders').textContent=tot.toLocaleString();
        document.getElementById('avgOrders').textContent=Math.round(tot/md.length).toLocaleString();
        document.getElementById('periodLabel').textContent='month';
        updateCharts(md);
        updateTable(md);
    }
}

// Chart and table update functions remain unchanged
function updateCharts(md){
    const l=md.map(d=>parseDate(d.date).getDate());
    if(fillRateChart)fillRateChart.destroy();
    fillRateChart=new Chart(document.getElementById('fillRateChart').getContext('2d'),{type:'line',data:{labels:l,datasets:[{label:'4 Day Fill Rate',data:md.map(d=>d.rate4),borderColor:'#d2b48c',backgroundColor:'rgba(210,180,140,0.1)',borderWidth:3,tension:0.4,fill:true},{label:'7 Day Fill Rate',data:md.map(d=>d.rate7),borderColor:'#8b7355',backgroundColor:'rgba(139,115,85,0.1)',borderWidth:3,tension:0.4,fill:true}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{backgroundColor:'rgba(255,255,255,0.95)',titleColor:'#8b7355',bodyColor:'#6b5d4f',borderColor:'#d2b48c',borderWidth:1,padding:12,displayColors:true,callbacks:{label:c=>c.dataset.label+': '+c.parsed.y.toFixed(2)+'%'}}},scales:{y:{beginAtZero:true,max:100,ticks:{callback:v=>v+'%',color:'#a0906f'},grid:{color:'rgba(210,180,140,0.1)'}},x:{ticks:{color:'#a0906f'},grid:{color:'rgba(210,180,140,0.1)'}}}}});
    if(ordersChart)ordersChart.destroy();
    ordersChart=new Chart(document.getElementById('ordersChart').getContext('2d'),{type:'bar',data:{labels:l,datasets:[{label:'Orders Remaining (4 Day)',data:md.map(d=>d.rem4),backgroundColor:'rgba(210,180,140,0.6)',borderColor:'#d2b48c',borderWidth:2},{label:'Orders Remaining (7 Day)',data:md.map(d=>d.rem7),backgroundColor:'rgba(139,115,85,0.6)',borderColor:'#8b7355',borderWidth:2}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:true,position:'top',labels:{color:'#8b7355',font:{size:11}}},tooltip:{backgroundColor:'rgba(255,255,255,0.95)',titleColor:'#8b7355',bodyColor:'#6b5d4f',borderColor:'#d2b48c',borderWidth:1,padding:12}},scales:{y:{beginAtZero:true,ticks:{color:'#a0906f'},grid:{color:'rgba(210,180,140,0.1)'}},x:{ticks:{color:'#a0906f'},grid:{color:'rgba(210,180,140,0.1)'}}}}});
}

function updateTable(md){
    const tb=document.getElementById('dataTable');tb.innerHTML='';
    md.forEach(d=>{
        const dt=parseDate(d.date),r=document.createElement('tr'),
        rc4=d.rate4>=85?'rate-good':d.rate4>=70?'rate-warning':'rate-poor',
        rc7=d.rate7>=95?'rate-good':d.rate7>=85?'rate-warning':'rate-poor';
        r.innerHTML=`<td>${dt.toLocaleDateString('en-US',{month:'short',day:'numeric'})}</td><td>${d.orders.toLocaleString()}</td><td>${d.rem4}</td><td>${d.rem7}</td><td class="${rc4}">${d.rate4.toFixed(2)}%</td><td class="${rc7}">${d.rate7.toFixed(2)}%</td>`;
        tb.appendChild(r);
    });
}

// Keep calendar code unchanged
function renderCalendarView(){/* existing calendar function here */}

// Tooltip functions unchanged
function showTooltip(e,d){const t=document.getElementById('tooltip'),dt=parseDate(d.date);t.innerHTML=`<strong>${dt.toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'})}</strong><br>Orders: ${d.orders.toLocaleString()}<br>4-Day Rate: ${d.rate4.toFixed(2)}%<br>7-Day Rate: ${d.rate7.toFixed(2)}%<br>Remaining (4d): ${d.rem4}<br>Remaining (7d): ${d.rem7}`;t.classList.add('show');moveTooltip(e)}
function hideTooltip(){document.getElementById('tooltip').classList.remove('show')}
function moveTooltip(e){const t=document.getElementById('tooltip');t.style.left=(e.clientX+15)+'px';t.style.top=(e.clientY+15)+'px'}

document.getElementById('yearSelect').addEventListener('change',e=>{currentYear=parseInt(e.target.value);if(currentView==='monthly')document.getElementById('monthSelect').disabled=false;updateDashboard()});
document.getElementById('monthSelect').addEventListener('change',e=>{currentMonth=parseInt(e.target.value);updateDashboard()});
document.querySelectorAll('.view-btn').forEach(b=>b.addEventListener('click',e=>{document.querySelectorAll('.view-btn').forEach(x=>x.classList.remove('active'));e.target.classList.add('active');currentView=e.target.dataset.view;document.querySelector('.monthly-view').classList.toggle('active',currentView==='monthly');document.querySelector('.calendar-view').classList.toggle('active',currentView==='calendar');document.getElementById('monthSelect').disabled=currentView==='calendar';updateDashboard()}));

updateDashboard();
</script>
</body>
</html>
